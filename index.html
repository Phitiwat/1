<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>‡πÄ‡∏Å‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ä‡∏≤‡∏¢‡∏™‡∏µ‡πà ‡∏õ6/5 ‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ</title>

<style>

body{
margin:0;
background:#d8c18a;
font-family:sans-serif;
overflow:hidden;
}

#hud{
color:#000;
text-align:center;
padding:8px;
font-size:18px;
}

#game{
display:grid;
grid-template-columns:repeat(4,1fr);
gap:10px;
padding:10px;
height:75vh;
}

.card{
background:#b48b4a;
border-radius:10px;
display:flex;
align-items:center;
justify-content:center;
font-size:40px;
user-select:none;
}

.open{
background:white;
}

#overlay{
position:fixed;
inset:0;
display:none;
align-items:center;
justify-content:center;
background:rgba(0,0,0,.6);
}

#overlay img{
width:70%;
animation:fadein .6s;
}

@keyframes fadein{
from{opacity:0}to{opacity:1}
}

#flash{
position:fixed;
inset:0;
background:white;
opacity:0;
pointer-events:none;
transition:.5s;
}

#aura{text-align:center;margin-top:4px;}

</style>
</head>

<body>

<div id="flash"></div>

<div id="hud">
‚ù§Ô∏è <span id="life">6</span>
 | ‡∏î‡πà‡∏≤‡∏ô <span id="level">1</span>

<select id="mode">
<option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
<option value="normal">‡∏õ‡∏Å‡∏ï‡∏¥</option>
<option value="hard">‡∏¢‡∏≤‡∏Å</option>
<option value="extreme">‡πÇ‡∏´‡∏î</option>
</select>

<div id="aura"></div>
</div>

<div id="game"></div>

<div id="overlay"><img id="overlayImg"></div>

<script>

const notes=["ùÖù","ùÖû","‚ô©","‚ô™","ùÑª","ùÑº","ùÑΩ","ùÑæ"];

const correct=new Audio("correct.mp3");
const wrong=new Audio("wrong.mp3");
const win=new Audio("win.mp3");
const lose=new Audio("lose.mp3");

let life=6,level=1,first=null,lock=false,match=0;

const modePairs={
easy:2,
normal:3,
hard:4,
extreme:4
};

function fadeOut(a){
let v=1;
let i=setInterval(()=>{
v-=0.05;
a.volume=v;
if(v<=0){clearInterval(i);a.pause();a.volume=1;}
},50);
}

function overlay(img){
const o=document.getElementById("overlay");
document.getElementById("overlayImg").src=img;
o.style.display="flex";
setTimeout(()=>o.style.display="none",1500);
}

function aura(x){
document.getElementById("aura").innerText="Aura "+x;
}

function build(){

document.getElementById("life").innerText=life;
document.getElementById("level").innerText=level;

const g=document.getElementById("game");
g.innerHTML="";
match=0;first=null;

let p=modePairs[mode.value];
let arr=[];

for(let i=0;i<p;i++){
arr.push(notes[i],notes[i]);
}

arr.sort(()=>Math.random()-0.5);

arr.forEach(n=>{
let c=document.createElement("div");
c.className="card";

c.onclick=()=>{

if(lock||c.classList.contains("open"))return;

c.classList.add("open");
c.innerText=n;

if(!first){first=c;return;}

if(first.innerText===n){

correct.play();
match++;
aura("+");

first=null;

if(match===p){
win.play();
overlay("victory.png");

document.getElementById("flash").style.opacity=1;
setTimeout(()=>document.getElementById("flash").style.opacity=0,400);

setTimeout(()=>{
level++;
build();
},2000);
}

}else{

wrong.play();
setTimeout(()=>fadeOut(wrong),600);

life--;
aura("-");

lock=true;

setTimeout(()=>{
first.classList.remove("open");
c.classList.remove("open");
first.innerText="";
c.innerText="";
first=null;
lock=false;
},1200);

if(life<=0){
lose.play();
overlay("lose.png");
}
}

};

g.appendChild(c);
});

}

mode.onchange=()=>{
life=6;
level=1;
build();
}

build();

</script>

</body>
 </html>
